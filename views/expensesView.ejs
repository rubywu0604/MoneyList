<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8" http-equiv="Permissions-Policy" content="interest-cohort=()">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <title>Expenses</title>
  </head>
  <body>
    <header>
      <ul>
        <li><a href="expenses.html">Expenses</a></li>
        <li><a href="incomes.html">Incomes</a></li>
      </ul>
      <h1>Expenses</h1>
    </header>

    <section>
      <h3>Add New expense</h3>
      <ul>
        <span class="">Date/Time</span>
        <input type="date" name="date" id="inputdate">
        <input type="time" name="time" id="inputtime">
        <span class="">Tag</span>
        <input type="text" name="tag" id="inputtag">
        <span class="">Amount</span>
        <input type="number" name="amount" id="inputamount">
        <button type="save" name="save" value="submit" id="click">Save</button>
      </ul>

      <script type="text/javascript">

        document.getElementById('click').onclick = function insertOne(){
          const date = document.getElementById('inputdate').value;
          const time = document.getElementById('inputtime').value;
          const tag = document.getElementById('inputtag').value.toString();
          const amount = parseInt(document.getElementById('inputamount').value);
          document.getElementById('listdate').textContent = date;
          document.getElementById('listtime').textContent = time;
          document.getElementById('listtag').textContent = tag;
          document.getElementById('listamount').textContent = amount;

          const data = {date, time, tag, amount};

          const options = { // package data as a POST
            method: 'POST',
            headers: {
              "Content-Type": "application/json"
            },
            body: JSON.stringify(data) //put data into javascript object
          };

          fetch('/expenses.html', options)
            .then(response => {
              console.log(JSON.parse(options.body), response);
            })
          alert('expense saved!');
        };
      </script>
    </section>

    <footer>
      <h3>Expenses List</h3>
      <table class="table">
      <thead>
        <tr>
          <th scope="col">Date</th>
          <th scope="col">Time</th>
          <th scope="col">Tag</th>
          <th scope="col">Amount</th>
       </tr>
     </thead>
     <tbody class="table-group-divider">
       <tr>
         <th id="listdate"></th>
         <td id="listtime"></td>
         <td id="listtag"></td>
         <td id="listamount"></td>
       </tr>
       <% historyExpList.forEach(expList => { %>
       <tr>
         <th><p><%= expList.date %></p></th>
         <td><p><%= expList.time %></p></td>
         <td><p><%= expList.tag %></p></td>
         <td><p><%= expList.amount %></p></td>
      </tr>
      <% }) %>
     </tbody>
     </table>
   </footer>
  </body>
</html>